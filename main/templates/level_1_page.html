{% extends 'base.html' %}

{% block title %}Level 1 - Highlights and Lowlights{% endblock %}

{% block content %}
<div class="main-container">
    <h1>All Highlights and Lowlights</h1>

    <!-- Current Week Submitted Texts -->
    <h2>Current Week</h2>
    {% for div, subdivisions in grouped_data_current_week.items %}
        <div class="division-box">
            <h3>{{ div }}</h3>
            {% for sub_div, data in subdivisions.items %}
                <h4>{{ sub_div }}</h4>
                <div class="submitted-texts">
                    <div class="submitted-column">
                        <h5>Highlights</h5>
                        <ul>
                            {% for text in data.highlights %}
                                <li>
                                    <strong>{{ text.user.profile.div }} - {{ text.user.profile.sub_div }} ({{ text.created_at|date:"Y-m-d H:i" }}):</strong> {{ text.text }}
                                    <a href="{% url 'edit_text' text.id %}" class="button">Edit</a>
                                    <a href="{% url 'delete_text' text.id %}" onclick="return confirm('Are you sure you want to delete this text?');">Delete</a>
                                </li>
                            {% empty %}
                                <p>No highlights submitted this week.</p>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="submitted-column">
                        <h5>Lowlights</h5>
                        <ul>
                            {% for text in data.lowlights %}
                                <li>
                                    <strong>{{ text.user.profile.div }} - {{ text.user.profile.sub_div }} ({{ text.created_at|date:"Y-m-d H:i" }}):</strong> {{ text.text }}
                                    <a href="{% url 'edit_text' text.id %}" class="button">Edit</a>
                                    <a href="{% url 'delete_text' text.id %}" onclick="return confirm('Are you sure you want to delete this text?');">Delete</a>
                                </li>
                            {% empty %}
                                <p>No lowlights submitted this week.</p>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endfor %}
     <!-- Button to Export PowerPoint -->
    <form method="GET" action="{% url 'generate_ppt' %}">
        <button type="submit" class="button">Export to PowerPoint</button>
    </form>

    <!-- Older Submitted Texts -->
    <h2>Older Texts</h2>
    {% for div, subdivisions in grouped_data_old.items %}
        <div class="division-box">
            <h3>{{ div }}</h3>
            {% for sub_div, data in subdivisions.items %}
                <h4>{{ sub_div }}</h4>
                <div class="submitted-texts">
                    <div class="submitted-column">
                        <h5>Highlights</h5>
                        <ul>
                            {% for text in data.highlights %}
                                <li>
                                    <strong>{{ text.user.profile.div }} - {{ text.user.profile.sub_div }} ({{ text.created_at|date:"Y-m-d H:i" }}):</strong> {{ text.text }}
                                    <a href="{% url 'edit_text' text.id %}" class="button">Edit</a>
                                    <a href="{% url 'delete_text' text.id %}" onclick="return confirm('Are you sure you want to delete this text?');">Delete</a>
                                </li>
                            {% empty %}
                                <p>No older highlights available.</p>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="submitted-column">
                        <h5>Lowlights</h5>
                        <ul>
                            {% for text in data.lowlights %}
                                <li>
                                    <strong>{{ text.user.profile.div }} - {{ text.user.profile.sub_div }} ({{ text.created_at|date:"Y-m-d H:i" }}):</strong> {{ text.text }}
                                    <a href="{% url 'edit_text' text.id %}" class="button">Edit</a>
                                    <a href="{% url 'delete_text' text.id %}" onclick="return confirm('Are you sure you want to delete this text?');">Delete</a>
                                </li>
                            {% empty %}
                                <p>No older lowlights available.</p>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</div>
{% endblock %}